# `mknod`와 `insmod` 설명

## `insmod` (insert module)

`insmod`는 리눅스 커널에 **커널 모듈(.ko 파일)**을 동적으로 로드(적재)하는 명령어입니다.

**역할:**
*   컴파일된 커널 모듈 파일(예: `ledkey_poll.ko`)을 커널의 실행 중인 이미지에 추가합니다.
*   모듈이 로드되면, 해당 모듈에 포함된 디바이스 드라이버나 기타 커널 기능이 활성화됩니다.
*   디바이스 드라이버의 경우, 이 시점에 커널에 자신의 존재를 알리고 주 번호(major number)를 할당받거나 요청합니다.

**예시:**
```bash
insmod ledkey_poll.ko
```

## `mknod` (make node)

`mknod`는 리눅스 파일 시스템의 `/dev` 디렉토리에 **디바이스 노드(device node) 파일**을 생성하는 명령어입니다. 이 디바이스 노드는 사용자 공간의 애플리케이션이 하드웨어 장치와 통신하기 위한 인터페이스 역할을 합니다.

**역할:**
*   `/dev` 디렉토리에 특정 하드웨어 장치 또는 가상 장치에 대한 특수 파일(디바이스 파일)을 생성합니다.
*   이 명령어를 통해 생성되는 디바이스 파일은 실제 데이터를 저장하지 않고, 커널의 해당 디바이스 드라이버로 요청을 전달하는 통로 역할을 합니다.
*   디바이스 노드를 생성할 때, 해당 노드가 어떤 드라이버(주 번호)와 어떤 특정 장치 인스턴스(부 번호)에 연결될지를 명시합니다.

**`mknod` 명령어의 형식:**
```bash
mknod [이름] [타입] [주 번호] [부 번호]
```
*   **이름**: `/dev` 디렉토리 아래에 생성될 디바이스 파일의 경로 (예: `/dev/ledkey`)
*   **타입**: 디바이스의 종류를 나타냅니다.
    *   `c`: 문자 디바이스 (Character Device) - 데이터를 바이트 스트림으로 처리 (예: 키보드, 마우스, 시리얼 포트)
    *   `b`: 블록 디바이스 (Block Device) - 데이터를 블록 단위로 처리 (예: 하드 디스크, USB 드라이브)
*   **주 번호 (Major Number)**: 해당 디바이스를 제어하는 디바이스 드라이버를 식별하는 고유 번호입니다. 이 번호는 `insmod`를 통해 로드된 드라이버가 커널에 등록될 때 할당받은 주 번호와 일치해야 합니다.
*   **부 번호 (Minor Number)**: 같은 주 번호를 가진 여러 장치 중에서 특정 장치 인스턴스를 식별하는 번호입니다.

**예시:**
```bash
mknod /dev/ledkey c 230 0
```
이 명령어는 `/dev/ledkey`라는 이름으로, 주 번호 230, 부 번호 0을 가진 문자 디바이스 노드를 생성합니다.

## `insmod`와 `mknod`의 관계

1.  **`insmod`**: 디바이스 드라이버를 커널에 로드하여, 해당 드라이버가 특정 주 번호와 연결되도록 합니다. (커널 내부의 매핑)
2.  **`mknod`**: 사용자 공간에서 `/dev` 디렉토리에 디바이스 노드 파일을 생성합니다. 이때 `mknod`에 지정된 주 번호는 `insmod`로 로드된 드라이버의 주 번호와 일치해야 합니다.

이 두 과정이 모두 완료되어야 애플리케이션이 `/dev` 경로를 통해 디바이스 드라이버와 상호작용할 수 있게 됩니다.
